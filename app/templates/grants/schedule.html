{% extends "base.html" %}

{% block title %}Vesting Schedule - SpaceX Stonks{% endblock %}

{% block content %}
<div class="page">
    <header class="page-header">
        <h1>Complete Vesting Schedule</h1>
    </header>

    {% if vest_events %}
    <div class="table-container">
        <table class="data-table">
            <thead>
                <tr>
                    <th>Vest Date</th>
                    <th>Grant Type</th>
                    <th>Share Type</th>
                    <th>Shares Vesting</th>
                    <th>Price at Vest</th>
                    <th>Gross Value</th>
                    <th>Payment Method</th>
                    <th>Tax Withholding</th>
                    <th>Shares Received</th>
                    <th>Net Value</th>
                    <th>Status</th>
                </tr>
            </thead>
            <tbody>
                {% for vest in vest_events %}
                <tr class="{% if vest.is_vested %}vested-row{% endif %}">
                    <td>{{ vest.vest_date.strftime('%Y-%m-%d') }}</td>
                    <td><span class="badge badge-{{ vest.grant.grant_type }}">{{ vest.grant.grant_type.replace('_', ' ').title() }}</span></td>
                    <td><span class="badge badge-share">{{ vest.grant.share_type.upper() }}</span></td>
                    <td>{{ "{:,.2f}".format(vest.shares_vested) }}</td>
                    <td>${{ "{:,.2f}".format(vest.share_price_at_vest or 0) }}</td>
                    <td>${{ "{:,.2f}".format(vest.value_at_vest) }}</td>
                    <td>
                        <span class="badge {% if vest.payment_method == 'cash_to_cover' %}badge-success{% else %}badge-pending{% endif %}">
                            {{ vest.payment_method.replace('_', ' ').title() }}
                        </span>
                    </td>
                    <td>
                        {% if vest.payment_method == 'cash_to_cover' %}
                            ${{ "{:,.2f}".format(vest.cash_to_cover) }}
                        {% else %}
                            {{ "{:,.2f}".format(vest.shares_sold_to_cover) }} shares
                        {% endif %}
                    </td>
                    <td class="highlight">{{ "{:,.2f}".format(vest.shares_received) }}</td>
                    <td class="highlight">${{ "{:,.2f}".format(vest.net_value) }}</td>
                    <td>
                        {% if vest.is_vested %}
                        <span class="badge badge-success">‚úì Vested</span>
                        {% else %}
                        <span class="badge badge-pending">‚è≥ Pending</span>
                        {% endif %}
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
    {% else %}
    <div class="empty-state-large">
        <div class="empty-icon">üìÖ</div>
        <h2>No vesting events</h2>
        <p>Add grants to see your vesting schedule</p>
        <a href="{{ url_for('grants.add_grant') }}" class="btn btn-primary">+ Add Grant</a>
    </div>
    {% endif %}
</div>
{% endblock %}
